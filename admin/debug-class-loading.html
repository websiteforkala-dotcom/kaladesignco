<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug AdminPanel Class Loading</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .log { margin: 5px 0; padding: 5px; background: #f0f0f0; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
    </style>
</head>
<body>
    <h1>Debug: AdminPanel Class Loading</h1>
    <div id="log"></div>

    <script>
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            document.getElementById('log').appendChild(div);
            console.log(message);
        }

        log('Starting debug session...');
        log('Checking initial window state...');
        log(`window.AdminPanel: ${typeof window.AdminPanel}`);
        log(`window.adminPanel: ${typeof window.adminPanel}`);

        // Monitor window.AdminPanel changes
        let checkCount = 0;
        const checkInterval = setInterval(() => {
            checkCount++;
            if (window.AdminPanel) {
                log(`✅ AdminPanel found after ${checkCount * 100}ms`, 'success');
                log(`AdminPanel type: ${typeof window.AdminPanel}`, 'success');
                log(`AdminPanel constructor: ${window.AdminPanel.name}`, 'success');
                clearInterval(checkInterval);
            } else if (checkCount > 100) { // Stop after 10 seconds
                log('❌ AdminPanel not found after 10 seconds', 'error');
                clearInterval(checkInterval);
            }
        }, 100);
    </script>

    <!-- Load dependencies first -->
    <script>
        log('Loading Supabase...');
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        log('Loading Supabase config...');
    </script>
    <script src="../database/supabase-config.js"></script>
    
    <script>
        log('Loading database service...');
    </script>
    <script src="../database/database-service.js"></script>
    
    <script>
        log('About to load admin-script.js...');
        log(`Current window.AdminPanel: ${typeof window.AdminPanel}`);
    </script>
    
    <!-- Load admin script -->
    <script src="admin-script.js"></script>
    
    <script>
        log('admin-script.js loaded');
        log(`window.AdminPanel after load: ${typeof window.AdminPanel}`);
        
        if (window.AdminPanel) {
            log('✅ AdminPanel immediately available!', 'success');
        } else {
            log('❌ AdminPanel not immediately available', 'error');
        }
    </script>
</body>
</html>